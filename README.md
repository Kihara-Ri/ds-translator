# 一个简单的命令行AI提问/翻译工具

## 👀Profile

通过使用`ds (参数) <问题>`调用Deepseek API并快速获取答案, 提供预设的提示词因此可以实现常用功能的快速响应

```bash
ds -h
usage: ds [-h] [-f] [-t] [-tr | -w | -tj | -s | -e] text [text ...]

DeepSeek API 多模式工具

positional arguments:
  text                 输入需要处理的文本, 如果不传入参数则默认问答
                       可以不使用引号来输入有间隔的英文单词, 但是问号需要转义字符\

options:
  -h, --help           show this help message and exit
  -f, --stream-false   不采用流式传输，完整返回结果后再输出，适用于短文本
  -t, --stream-true    采用流式传输，适用于长文本
  -tr, --translate     中日英三语翻译, 识别语言并翻译成另外两种语言
  -w, --word           解释单词/词组/短语, 输出含义和语境及其应用场景, 并且给出例句
  -tj, --translate-jp  将中文翻译成日文, 更加精细化
  -s, --sentence       解释句子, 输出其中难以理解的词汇和用法, 并给出翻译
  -e, --en-synonyms    查询英文同义词/近义词, 输出表格
```

## ⚙️使用之前

使用以下命令安装依赖:
```bash
pip install -r requirements.txt
```

软链接，方便在终端中直接使用`ds`命令，注意只能在UNIX系统中使用:
```bash
# 软链接
sudo ln -s <必须确保为绝对路径>/source/main.py /usr/local/bin/ds
# 保存API密钥到环境变量中
export DEEPSEEK_API_KEY="你的密钥"
```

## 💡点子王🤓👆

 - [ ] 添加查询单词记录的接口，完善信息
 - [ ] 添加编辑功能，这不又回到前端了吗
 - [ ] 我可以为翻译添加很多细分功能，但是如果设置按钮/工具栏又显得太繁琐，更好的方法是先检测用户的输入，然后根据输入来推送其中的一个功能或几个功能

## 🔧修修补补

- [x] 请求API的时候出现等待的文字提示，附加加载动画
- [x] 每次请求API时，返回输出的字数，并且告诉我token数
- [x] 将查询过的信息加入日志，打上时间标记，查询单词的话自动加入生词本`json`文件
- [ ] 让流式输出更丝滑
- [ ] 根据使用AI的时间不同，自动切换使用的模型，根据错峰收费规则，在晚上特定时间段使用推理能力更强的模型和v3模型价格相同，启用模型时在请求时附加模型名称

目前还有一些小问题等待解决:
- [x] 请求时的动画，在请求完成后更改为`请求完毕`，而不是最后一帧留下的东西
- [x] 点状动画更新出现问题
- [x] 耗时因为不明原因没有顶格，需要重新写，目前还没有想到更好的架构
- [x] 流式传输时需要分开动画和大模型文字输出，暂时文字输出还会被状态动画吞掉
- [ ] 流式传输动画问题暂时妥协了一下，在输出文字时取消了动画，但有些情况下回答会被稳定吞掉第一个字，目前原因不明
- [ ] 命令参数开始变多，需要分类处理，装在另一个文件中
- 写入`json`文件的代码泛用性和健壮性需要进一步加强

Deepseek API这个官方文档真是一言难尽...

可能的交互方式：
```bash
请阅读以下英文句子：“<英文句子>”。  
（1）先自行批注：在句子中用“[]”标出所有你认为难的部分；  
（2）再分别对每个标注部分，按“释义 + 语法作用 + 使用建议”格式进行解释；  
（3）最后用一句中文总结，并提出一个练习题，让用户复现其中一个难点结构。
```
对于这种类型的交互，我已经想到了一个在iOS上一个用户友好的实现方案...



